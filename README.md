# meme-classification
+ 模式识别课程设计
+ 基于ResNeXt表情包分类器
# 问题背景与描述
当前，我们在网上聊天的时候会使用各种各样的表情包。表情包可以用来简短精悍有趣地表达自己的内心想法，它不仅新潮幽默，更是能激发人的智慧和人的各种语言天赋。弥补了只有文字不能表达的情景，可以让我们的聊天更加有趣。当见识到各种各样的表情包时，我们产生了一个想法，能不能让电脑自动的分类各种各样的表情包呢？这也是我今天课程设计的主题。
# 数据预处理
## 本地
- 数据需要仿照Cifar-10数据集的格式进行处理。
- 对于所有已获得的表情包图片，如果其中有gif格式的文件，提取当中的几帧直接保存成jpg格式的文件，而对于其他格式的图片，都转换成jpg格式的图片。
- 然后把图片大小修改为32*32。
- 由于数据量不足，这里把同一张图片进行了旋转操作，一张图片变成了4张。重命名图片为“类别_图片编号”并把全部图片放在同一个文件夹中。
- 压缩文件夹（ok.zip），并上传到服务器，进行后续的训练操作。
## colab
- 在模型训练之前，需要进行以下预处理操作：
- 解压刚才上传的文件。
- 对每个图片，用opencv读取，变成32*32*3的矩阵，并从文件名获得label。
- 用sklearn工具分出训练集和测试集（8:2）。
- 把label转换成onehot编码。
- 随机打乱顺序。
# 模型训练过程
- 整个模型都是在Colab进行训练的
- 训练的方法是先利用上面预处理号的数据集，然后修改从[SE_ResNeXt.py](https://github.com/taki0112/SENet-Tensorflow/blob/master/SE_ResNeXt.py) 下载的ResNeXt模型代码。
- 该代码是针对Cifar-10数据集制作的，因此需要修改部分代码以适应该表情包数据集。
- 模型的每次训练都需要运行100个迭代，其详细的训练过程可以看下面的网址：[colab](https://colab.research.google.com/drive/1YfkNHLj9KDEy-_cUMDQtn_4NCkeDb2tQ)或[github](https://github.com/TonyNgcn/meme-classification/blob/master/sernet.ipynb)
# 单张图片使用模型预测
- 训练好得到的模型，可以修改部分代码以用于预测单张图片。得到的结果是一个prediction，它可以给出需要预测的图片经过模型之后的得分。取最高分的类别作为最终的类别输出就可以了。
- 可以参考[colab](https://colab.research.google.com/drive/1YfkNHLj9KDEy-_cUMDQtn_4NCkeDb2tQ)或[github](https://github.com/TonyNgcn/meme-classification/blob/master/sernet.ipynb)最后的部分或者直接使用标注v1.6的几个python文件
# 实验结果对比
## ResNeXt在原版Cifar-10数据集上
经过100次迭代，ResNeXt网络结构在cifar-10训练集上的准确率是100%，测试集为94.57%
## ResNeXt在表情包数据集上
### 未经修改的ResNeXt（v1.3）
- 网络结构与ResNeXt一样，只是修改部分代码适应该表情包数据集
- 经过100次迭代的训练后，得出了训练集上的准确率是100%，测试集上的准确率是97.08%
### ResNeXt增加一个基本块（v1.4）
- 网络结构在ResNeXt的基础上（1.3版本），增加了一个residual_layer（基本块）。
- 经过100次迭代的训练后，得出了训练集上的准确率是100%，测试集上的准确率是98.77%
### ResNeXt减少一个基本块（v1.5）
- 网络结构在ResNeXt的基础上（1.3版本），减少了一个residual_layer（基本块）。
- 经过100次迭代的训练后，得出了训练集上的准确率是100%，测试集上的准确率是98.07%
# 总结
- 基于ResNeXt网络结构的表情包分类器在本次课程设计中取得了非常好的效果，分类器在训练集上的准确率达到了100%，而在测试集上的准确率也达到了97%，且经过对比，发现增加或减少一个ResNeXt网络的基本块，对模型的准确率的影响并不大。虽然在刚开始的时候，准确率的波动较大，而且准确率比原版的ResNeXt网络有较大的差异，但由于在运行100次迭代后影响较小，因此，我们可以认为该网络结构在这个表情包数据集上的效果很好。但是，不可否认的是，由于数据集的规模较少（总共只有4585（训练集）+1147（测试集）=5732张图片，而且这个已经是经过旋转操作增加数据集后的数据），以及进行旋转操作增加数据量的方法的约束，这样去制作数据集的方式可能不太规范，并会造成较大的误差。而在使用单张图片验证模型正确率的过程中，我们认为这个模型（v1.3）在预测部分表情包图片时仍有错误的情况出现。在下一阶段，可能仍需要使用更多的数据对模型进行训练和测试。
